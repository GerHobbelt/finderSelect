(function(e){e.fn.finderSelectHighlight=function(t){if(t===undefined){t="selected"}return e(this).addClass(t)};e.fn.finderSelectUnHighlight=function(t){if(t===undefined){t="selected"}return e(this).removeClass(t)};e.fn.finderSelectHighlighted=function(t){if(t===undefined){t="selected"}return e(this).hasClass(t)};e.fn.finderSelectToggleHighlight=function(t){if(t===undefined){t="selected"}return e(this).toggleClass(t)};e.fn.finderSelectBetween=function(t,n){if(t>n){return e(this).filter(":lt("+t+")").filter(":gt("+n+")")}else{return e(this).filter(":lt("+n+")").filter(":gt("+t+")")}};e.fn.finderSelectDisableSelection=function(){return e(this).css({"-moz-user-select":"-moz-none","-moz-user-select":"none","-o-user-select":"none","-khtml-user-select":"none","-webkit-user-select":"none","-ms-user-select":"none","user-select":"none"}).bind("selectstart",function(){return false})};e.fn.finderSelect=function(t){var n={"class":"selected",children:false,event:"mousedown",cursor:"pointer"};e.extend(n,t);if(n.children===false){n.children=e(this).children().get(0).tagName}e(this).finderSelectDisableSelection();e(this).find(n.children).css("cursor",n.cursor);var r=e(this);r.data("down",false);r.mousedown(function(){r.data("down",true)}).mouseup(function(){r.data("down",false)});e(this).on("mouseenter",n.children,function(t){if(r.data("down")&&(t.ctrlKey||t.metaKey)){e(this).finderSelectToggleHighlight(n.class);r.trigger("finderSelectUpdate")}});e(this).on(n.event,n.children,function(t){var i=e(this);var s=r.data("finderSelectPrimary");var o=r.data("finderSelectSecondary");var u=r.find(n.children);var a=u.index(this);var f=u.index(u.eq(s).nextAll("."+n.class).first());if(!u.eq(s).finderSelectHighlighted(n.class)){s=f}if(t.shiftKey){if(s==null){s=0}if(o!=null){i.finderSelectHighlight(n.class);if(s<o&&s<a&&a>o){u.finderSelectBetween(o,a).finderSelectHighlight(n.class)}if(s<o&&s<a&&a<o){u.eq(o).finderSelectUnHighlight(n.class);u.finderSelectBetween(o,a).finderSelectUnHighlight(n.class)}if(s<o&&s>a&&a<o){u.eq(o).finderSelectUnHighlight(n.class);u.finderSelectBetween(o,s).finderSelectUnHighlight(n.class);u.finderSelectBetween(a,s).finderSelectHighlight(n.class)}if(s>o&&s<a&&a>o){u.eq(o).finderSelectUnHighlight(n.class);u.finderSelectBetween(o,s).finderSelectUnHighlight(n.class);u.finderSelectBetween(a,s).finderSelectHighlight(n.class)}if(s>o&&s>a&&a>o){u.eq(o).finderSelectUnHighlight(n.class);u.finderSelectBetween(o,a).finderSelectUnHighlight(n.class)}if(s>o&&s>a&&a<o){u.finderSelectBetween(o,a).finderSelectHighlight(n.class)}if(s==o&&o>a){u.finderSelectBetween(o,a).finderSelectHighlight(n.class)}if(s==o&&o<a){u.finderSelectBetween(o,a).finderSelectHighlight(n.class)}}else{u.finderSelectBetween(a,s).finderSelectHighlight(n.class);i.finderSelectHighlight(n.class)}r.data("finderSelectPrimary",s);r.data("finderSelectSecondary",a)}else{if(t.ctrlKey||t.metaKey){if(i.finderSelectHighlighted(n.class)){i.finderSelectUnHighlight(n.class);r.data("finderSelectPrimary",a);r.data("finderSelectSecondary",null)}else{i.finderSelectHighlight(n.class);r.data("finderSelectPrimary",a);r.data("finderSelectSecondary",null)}}else{u.finderSelectUnHighlight(n.class);i.finderSelectHighlight(n.class);r.data("finderSelectPrimary",a);r.data("finderSelectSecondary",null)}}r.trigger("finderSelectUpdate")})}})(jQuery)